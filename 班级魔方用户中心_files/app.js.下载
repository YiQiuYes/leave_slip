function tpl2html(e,t){return code="var p=[];with(this){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');",new Function(code).apply(t)}function text2html(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n?|\n/g,"<br>")}function loadScript(e,t,a){for(var n=document.getElementsByTagName("script"),o=0;o<n.length;o++){var r=n[o];if(""==r.innerHTML.trim()){var i=r.getAttribute("key4unique"),l=r.getAttribute("src");if("string"==typeof a&&"string"==typeof i&&i==a||"string"==typeof l&&l==e)return void t()}}var c=document.createElement("script");c.type="text/javascript",!c.attachEvent||c.attachEvent.toString&&c.attachEvent.toString().indexOf("[native code")<0?c.addEventListener("load",function(e){("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState))&&t(e)},!1):c.attachEvent("onreadystatechange",function(e){("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState))&&t(e)}),void 0!==a&&c.setAttribute("key4unique",a),c.src=e,document.getElementsByTagName("head")[0].appendChild(c)}_modaltpl='<div class="modal fade" id="automodal_<%=idindex%>" tabindex="-1" role="dialog" aria-hidden="true">    <div class="modal-dialog  modal-sm modal-dialog-centered" role="document">        <div class="modal-content gradient-green  z4">            <div class="modal-header">                <h5 class="modal-title" id="exampleModalLabel"><%=title%></h5>                <button type="button" class="close" data-dismiss="modal" aria-label="Close">                    <span aria-hidden="true">×</span>                </button>            </div>            <form method="<%=method%>" <% if(action.length>0){ %> action="<%=action%>" <% } %> >            <input type="hidden" name="op" value="<%=op%>">            <div class="modal-body"><%=body%><%=bodyext%></div>            <div class="modal-footer">                <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>                <button type="submit" class="btn btn-primary">提交</button>            </div>            </form>        </div>    </div></div>';var ktmfautoindex=1;function modal(e){e.idindex=ktmfautoindex++,_html=tpl2html(_modaltpl,e),$(_html).modal()}function modal_promot(e,t){_dft="",_placeholder="",void 0!==t.default&&(_dft=t.default),void 0!==t.placeholder&&(_placeholder=t.placeholder),t.body='<input type="text" class="form-control" name="'+e+'" value="'+_dft+'" placeholder="'+_placeholder+'" >',modal(t=$.extend({title:"请输入",method:"post",placeholder:"",default:"",action:"",op:"",body:"",bodyext:""},t))}function modal_select(e,t,a){_html='<select class="form-control" name="'+e+'" >',$.each(t,function(e,t){void 0!==t.value?_value=t.value:void 0!==t.id?_value=t.id:_value=e,_html+='<option value="'+_value+'">'+t.name+"</option>"}),_html+="</select>",a.body=_html,modal(a=$.extend({title:"请选择",method:"post",action:"",op:"",body:"",bodyext:""},a))}function modal_form(e,t){}function weuitimepicker(e){var t=e,a=[],n=0;for(n=0;n<24;n++)a.push({label:n+"时",value:n});var o=[];for(n=0;n<60;n++)o.push({label:n+"分",value:n});var r=[];for(n=0;n<60;n++)r.push({label:n+"秒",value:n});weui.picker(a,o,r,{defaultValue:[7,40,0],onChange:function(e){console.log(e)},onConfirm:function(e){$(t).val(zeroPad(e[0])+":"+zeroPad(e[1])+":"+zeroPad(e[2])).trigger("change")},id:"timePicker",title:"选择时间"})}function weuitimepicker_nos(e,t,a,n){var o=e,r=[],i=0;for(i=0;i<24;i++)r.push({label:zeroPad(i)+"时",value:i});var l=[];for(i=0;i<60;i++)l.push({label:zeroPad(i)+"分",value:i});"string"==typeof a&&a?a=a.split(":").map(function(e){return parseInt(e)}):a||(a=[7,40]);weui.picker(r,l,{defaultValue:a,onConfirm:function(e){var a=zeroPad(e[0])+":"+zeroPad(e[1]);$(o).val(a).trigger("change"),t&&t(e,a)},id:n||"timeNosPicker",title:"选择时间"})}function weuidatetimepicker(e){var t=e,a="",n=$(e).attr("format")||"Y-m-d H:i:s",o="Y-m-d"!==n,r="Y-m-d H:i:s"===n,i=!1;["rd[fn_907]","rd[fn_2379]"].includes($(e).attr("name"))&&(r=!1,i=!0);var l=new Date,c=l.getHours(),d=l.getMinutes(),s=(l.getSeconds(),$(e).hasClass("vue"));weui.datePicker({onConfirm:function(e){a=e[0]+"-"+zeroPad(e[1])+"-"+zeroPad(e[2])+" "},onClose:function(){if(""!=a){if(!o)return $(t).val(a).trigger("change"),void(s&&t.dispatchEvent(new CustomEvent("input")));var e=[],n=0;for(n=0;n<24;n++)e.push({label:n+"时",value:n});var l=[];for(n=0;n<60;n++)l.push({label:n+"分",value:n});var f=[e,l];if(r){var u=[];for(n=0;n<60;n++)u.push({label:n+"秒",value:n});f.push(u)}f.push({defaultValue:[c,i?0:d,0],onChange:function(e){},onConfirm:function(e){var n=a+zeroPad(e[0])+":"+zeroPad(e[1]);r&&(n+=":"+zeroPad(e[2])),$(t).val(n).trigger("change"),s&&t.dispatchEvent(new CustomEvent("input"))},id:"timePicker",title:"选择时间（"+a+"）"}),weui.picker.apply(weui.picker,f)}},id:"datePicker",title:"选择日期"})}function zeroPad(e){return e<10?"0"+e:e}function calendarDraw(e,t){date=new Date(e,t,0);var a=new Date(date.getFullYear(),date.getMonth()+1,0).getDate();new Date(date.getFullYear(),date.getMonth(),0).getDate(),new Date(date.getFullYear(),date.getMonth()+2,0).getDate();date.setDate(1);var n=date.getDay();0==n&&(n=7),date=new Date(e,t,0);var o="<table class='calendarDrawTable'><tr><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th>";_index=0;for(var r=1;r<=n%7;r++)_index%7==0&&(o+="</tr><tr>"),_index++,o+="<td></td>";for(var i=1;i<=a;i++)_index%7==0&&(o+="</tr><tr>"),_index++,_dta=new Array,_dta.push(e),_dta.push(zeroPad(t)),_dta.push(zeroPad(i)),o+='<td dt="'+_dta.join("")+'">'+i+"</td>";o+="</tr></table>";var l=date.getMonth()+1,c=date.getFullYear();return 1==l?(PrevYear=c-1,PrevMonth=12):(PrevYear=c,PrevMonth=l-1),12==l?(NextYear=c+1,NextMonth=1):(NextYear=c,NextMonth=l+1),{html:o,cur:{year:e,month:t},prev:{year:PrevYear,month:PrevMonth},next:{year:NextYear,month:NextMonth}}}function bjmf_studentinfo(e,t){$.get("/teacher/data/course/"+e+"/student/"+t,function(e){_info="姓名:"+e.name+"\n",_info+="学号:"+e.no+"\n",_info+="性别:"+e.sex+"\n",_info+="班级:"+e.groupname+"\n",void 0!==e.roomname&&(_info+="宿舍:"+e.roomname+"\n"),alert(_info)},"json")}function html_upload_js(e,t,a,n){if($("#bjmfuploader_"+e).length>0&&$("#"+e).next("div.jFiler").remove(),$("#"+e).after('<input type="file" name="files[]" id="bjmfuploader_'+e+'" multiple autocomplete="off">'),"function"!=typeof kkbupfileschged){var o=void 0===window.sitecdn?"//c.d8n.cn":window.sitecdn;$('<link rel="stylesheet" type="text/css" href="'+o+'/res/upload/css/jquery.filer.css?3">').appendTo("body"),$('<script src="/res/upload/js/jquery.filer.min.js?12" type="text/javascript"><\/script>').appendTo("body"),window.kkbupfileschged=function(e,t){$("#"+t).val(JSON.stringify(e))}}var r=[],i=$("#"+e).val();if(i&&i.length>5){var l=JSON.parse($("#"+e).val());$.each(l,function(e,t){void 0!==t.file&&void 0!==t.name&&void 0!==t.type&&void 0!==t.size&&r.push(t)})}filer_default_opts.ossRole=t,filer_default_opts.ossPath=a||"",$("#bjmfuploader_"+e).filer($.extend({changeInput:filer_default_opts.changeInput2,showThumbs:!0,theme:"dragdropbox",templates:filer_default_opts.templates,dragDrop:filer_default_opts.dragDrop,uploadFile:filer_default_opts.uploadFile,onRemove:filer_default_opts.onRemove,onRemoved:filer_default_opts.onRemoved,beforeSelect:filer_default_opts.beforeSelect,files:r},n))}function get_current_role(){var e=location.pathname,t="student";return e.startsWith("/teacher")?t="teacher":e.startsWith("/org")&&(t="org"),t}function html_upload_js_auto(e,t,a){a=a||location.pathname,html_upload_js(e||"attachment",get_current_role(),a,t)}function upload_file_directly(e,t,a){"function"!=typeof kkbupfileschged&&$('<script src="/res/upload/js/jquery.filer.min.js?12" type="text/javascript"><\/script>').appendTo("body"),filer_default_opts.ossRole=get_current_role(),filer_default_opts.ossPath=location.pathname;var n=new FormData;filer_default_opts.prepareKey({uploadFile:"/uploadfile"},n,t,function(t){var o=location.hostname,r=o.startsWith("localhost")||o.endsWith(".local")||o.endsWith(".hans")||!t||!t.host,i=r?"files[]":"file",l=r?"/uploadfile":t.host;n.append(i,e);var c=new XMLHttpRequest;c.open("POST",l,!0),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.onreadystatechange=function(){if(4===c.readyState&&200===c.status){var e=JSON.parse(c.responseText);e&&401===e.code&&e.msg?alert(e.msg):e&&e.success?a([e.data]):e&&e.length?a(e):alert("上传失败！")}},c.send(n)})}$(function(){$("textarea.form-control,textarea.layui-textarea").each(function(){$(this).css("height",Math.max(this.scrollHeight,66)+"px"),$(this).css("overflow-y","hidden")}).on("input",function(){$(this).css("height","auto"),$(this).height(Math.max(this.scrollHeight,33))})});var bjmf_voice={localId:"",serverId:""},bjmf_luyin_ing=!1;function bjmf_wx_luyin_2texted(e){"undefined"!=typeof bjmf_wx_luyin_2texted_cb&&bjmf_wx_luyin_2texted_cb(e.translateResult)}function bjmf_wx_luyin_started(e){bjmf_luyin_ing=!0,$("#bjmf_luyin_area").html('<button type="button" onclick="bjmf_wx_luyin_stop()">录音中...点击停止</button>'),"undefined"!=typeof bjmf_wx_luyin_started_cb&&bjmf_wx_luyin_started_cb(e)}function bjmf_wx_luyin_stoped(e){bjmf_luyin_ing=!1,bjmf_voice.localId=e.localId,bjmf_wx_luyin_2text(),$("#bjmf_luyin_area").html('<button type="button" onclick="bjmf_wx_luyin_start()">开始录音</button>'),"undefined"!=typeof bjmf_wx_luyin_stoped_cb&&bjmf_wx_luyin_stoped_cb(e)}function bjmf_wx_luyin_start(){wx.startRecord({success:function(e){bjmf_luyin_ing=!0,bjmf_wx_luyin_started(e)},cancel:function(){bjmf_luyin_ing=!1,alert("已拒绝录音")}})}function bjmf_wx_luyin_stop(){wx.stopRecord({success:function(e){bjmf_voice.localId=e.localId,bjmf_wx_luyin_stoped(e)},fail:function(e){alert(JSON.stringify(e))}})}function bjmf_wx_luyin_2text(){wx.translateVoice({localId:bjmf_voice.localId,complete:function(e){e.hasOwnProperty("translateResult")?bjmf_wx_luyin_2texted(e):alert("无法识别")}})}function bjmf_title(){var e=document.title,t=$("header.fixed-header > .center");return t?(t.text()||e).trim():e}var wx_photo_serverids=[];function wx_camera_photo(e){wx_photo_serverids=[],wx.chooseImage({count:1,sizeType:["compressed"],sourceType:["camera"],success:function(t){var a=t.localIds;for(i=0;i<a.length;i++)wx.uploadImage({localId:a[i],isShowProgressTips:1,success:function(t){wx_photo_serverids.push(t.serverId),void 0!==e&&e(this.localId,t.serverId)},fail:function(e){alert("微信图片上传失败，请重试。".JSON.stringify(e))}})}})}function getGroupLabel(e){return(e.find(".control-label").text()||"").replace(/[*：:]+$/g,"")}function checkUnfinishedField(e){for(var t=$(e).find(".form-group:visible"),a=null,n=0;n<t.length;n++){var o=t.eq(n);if(!(o.find(".required-mark").length<=0)){var r=o.data("type");if(["radio","checkbox"].indexOf(r)>=0){if(o.find("input:checked").length<=0){a=getGroupLabel(o);break}}else{var i=o.find("input, textarea, select").filter("[name]").val();if(!i||""===$.trim(i)||"file"===r&&"[]"===$.trim(i)){a=getGroupLabel(o);break}}}}return!!a&&(weui.alert("请完成必填项："+a,{title:"提示"}),!0)}function _autoLinkTextNodesReplace(e,t,a){for(var n,o,r=[],i=[],l=0;null!==(n=e.exec(t));)o=n.index,n[1]&&n[0][0]!==n[1][0]&&o++,r.push(t.slice(l,o)),r.push(n[1]||n[0]),i.push(o),l=n.index+n[0].length,n[1]&&n[0][n[0].length-1]!==n[1][n[1].length-1]&&l--;if(i.length){for(r.push(t.slice(l)),o=0;o<r.length;o++)o%2&&(r[o]=a(r[o]));return r}return[t]}function _autoLinkTextNodes(e,t){try{document.querySelectorAll("span, p, td, label, div").forEach(function(a){a.childNodes.forEach(function(a){if(a.nodeType===Node.TEXT_NODE){var n=a.textContent,o=_autoLinkTextNodesReplace(e,n,t);if(o.length>1){for(var r=[],i=0;i<o.length;i++){var l;i%2?(l=document.createElement("span")).innerHTML=o[i]:l=document.createTextNode(o[i]),r.push(l)}a.replaceWith.apply(a,r)}}})})}catch(e){console.log(e)}}function autoLinkTextNodes(){_autoLinkTextNodes(/(?:^|[^a-zA-Z0-9])(1[3-9][0-9]{9})(?:[^a-zA-Z0-9]|$)/g,function(e){return'<a href="tel:'+e+'" class="link">'+e+"</a>"}),_autoLinkTextNodes(/https?:\/\/[-A-Za-z0-9+&@#\/%?=~_|!:,.;]+[-A-Za-z0-9+&@#\/%=~_|]/g,function(e){return'<a href="'+e+'" class="link" target="_blank">'+e+"</a>"})}function addRedDots(){$("[dote]").each(function(){var e=$(this),t=e.attr("dote");t&&(localStorage.getItem(t)||e.addClass("rt-dot"),e.hasClass("rt-dot-t")&&e.on("click",function(){localStorage.setItem(t,"true")}))})}function getFavoriteLinks(){try{var e=localStorage.getItem("exam_favorite_links")||"{}";e=JSON.parse(e)||{}}catch(t){console.log(t),e={}}return e}function countFavoriteLink(e){try{var t=getFavoriteLinks(),a=t[e.href]||0;t[e.href]=a+1,localStorage.setItem("exam_favorite_links",JSON.stringify(t))}catch(e){console.log(e)}}function renderFavoriteLinks(){try{var e=[],t=getFavoriteLinks();if($.each(t,function(t,a){a>=10&&e.push({href:t,count:a})}),e.length<=0)return;e.sort(function(e,t){return t.count-e.count});var a=$(".favorite-list .row"),n={};$(".card-body.menu-list .col-3 > a").each(function(){n[this.href]=$(this).parent()});var o=0;$.each(e,function(e,t){if(o>=4)return!1;n[t.href]&&(n[t.href].clone().appendTo(a),o++)}),o&&$(".favorite-list").show()}catch(e){console.log(e)}}function timeStr(e){return e&&e.endsWith?e.split(":").length<=2?e:e.endsWith(":00")?e.substring(0,e.length-3):e:e}function table_col_toggle(e,t,a){Array.isArray(t)||(t=[t]),$.each(t,function(t,n){$(e+" tr").find("td:eq("+n+"),th:eq("+n+")").toggle(a)})}function table2xls(e,t,a){var n=null,o="sheet1";"string"==typeof t?n=t:(n=t.filename,o=t.worksheet||"Worksheet");var r=$("#"+e).prop("outerHTML");$_html=$(r),$_html.removeAttr("style"),$_html.find("td[export='no']").remove(),$_html.find("th[export='no']").remove(),html2xls(r=$_html.prop("outerHTML"),n,o,a)}function html2xls(e,t,a,n){void 0===a&&(a="sheet1"),void 0===t&&(t="data"),t+=".xls",uri="data:application/vnd.ms-excel;base64,",xlstemplate='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style type="text/css">td{mso-number-format:"@"}</style></head><body>{table}</body></html>',base64=function(e){return window.btoa(unescape(encodeURIComponent(e)))},format=function(e,t){return e.replace(/{(\w+)}/g,function(e,a){return t[a]})};var o=format(xlstemplate,{worksheet:a,table:e}),r=base64(o);if(window.navigator.msSaveBlob){var i=b64toBlob(r);window.navigator.msSaveBlob(i,t)}else if(navigator.userAgent.indexOf("MicroMessenger")>-1||navigator.userAgent.indexOf("WindowsWechat")>-1){var l={content:o};$.post("/teacher/post2oss?ext=xls",l,function(e){e.error?alert(e.msg):document.location.href="/teacher/exp_result?file="+e.data},"json")}else{var c=$('<a style="display:none"></a>').appendTo("body");c[0].href=uri+r,c[0].download=t,c[0].click(),c.remove()}}function bjmform_snapshot(e,t){window["bjmform_snapshot_"+e]=$(t).html()}function bjmform_clear(e,t){var a="bjmform_snapshot_"+e;window[a]||bjmform_snapshot(e,t),$(t).html(window[a]),$(".form-control-datetimepicker").on("click",function(){weuidatetimepicker(this)}),bjmform_addr_auto_flag=!1}function bjmform_getdata_full(e,t){var a=bjmform_getdata(e,t);return $(e).find("[bjmfform_autogps]").each(function(){var e=$(this).attr("name");e.length<=t.length||e.substr(0,t.length)!==t||(e=e.substr(t.length+1,e.length-t.length-2),a[e]=$(this).val())}),a}function bjmform_ele_clear(e){var t=$(e).attr("type");void 0===t||"radio"!=t&&"checkbox"!=t?$(e).val(""):$(e).prop("checked",!1)}function bjmform_score_calc(){var e=0;return $("input[bjmf-score]:visible:checked").each(function(){var t=$(this).attr("bjmf-score");try{t=parseFloat(t),isNaN(t)||(e+=t)}catch(e){}}),$("option[bjmf-score]:selected").each(function(){if(0!=$(this).closest("select:visible").length){var t=$(this).attr("bjmf-score");try{t=parseFloat(t),isNaN(t)||(e+=t)}catch(e){}}}),$("#bjmf_score").val(e),e}function bjmform_ini(e,t,a,n){null!=e&&null!=e&&e||(e=[]),null==typeof n&&(n=0),$.each(e,function(e,a){$("[name='"+t+"["+e+"]'][type!=radio]").val(a),$("[name='"+t+"["+e+"]'][type=radio][value='"+a+"']").prop("checked",!0),"object"==typeof a&&$.each(a,function(a,n){$("[name='"+t+"["+e+"][]'][value='"+n+"']").prop("checked",!0),$("[name='"+t+"["+e+"]["+a+"]'][value='"+n+"']").prop("checked",!0),"object"==typeof n&&$.each(n,function(n,o){$("[name='"+t+"["+e+"]["+a+"][]'][value='"+o+"']").prop("checked",!0)})}),$("[name='"+t+"["+e+"][]'][value='"+a+"']").prop("checked",!0)});var o={};$.each(e,function(e,a){$("[name='"+t+"["+e+"]'][type=radio][title='"+a+"']").prop("checked",!0),$("[name='"+t+"["+e+"]']").find("option[title='"+a+"']").prop("selected",!0),"object"==typeof a&&$.each(a,function(a,n){$("[name='"+t+"["+e+"][]'][value='"+n+"']").prop("checked",!0),$("[name='"+t+"["+e+"]["+a+"]'][value='"+n+"']").prop("checked",!0),"object"==typeof n&&$.each(n,function(n,o){$("[name='"+t+"["+e+"]["+a+"][]'][value='"+o+"']").prop("checked",!0)})});var n=$("[name='"+t+"["+e+"]'][field-type=draw][value]");n.length&&(o[e]=n)}),Object.keys(o).length&&render_draw_pad(function(){$.each(o,function(e,t){DrawPad.renderResult(t)})});var r=function(e){var t=[];$("[link_n="+e+"]").each(function(e,a){void 0!==$(this).attr("type")?"text"==$(this).attr("type")?t.push($(this).val().trim()):$(this).prop("checked")&&t.push($(this).parent().text().trim()):t.push($(this).find("option:selected").text().trim())}),$("[linkn="+e+"]").each(function(e,a){var n=JSON.parse($(this).attr("linkv")),o=!1;$.each(n,function(e,a){jQuery.inArray(a,t)>-1&&(o=!0)}),o?$(this).show("fast"):($(this).hide("fast"),$(this).find("input,select").each(function(e,t){bjmform_ele_clear($(this)),$(this).change()}))})};($("[link_n]").bind("change",function(){var e=$(this).attr("link_n");r(e)}),$("[link_n]").each(function(){r($(this).attr("link_n"))}),$("[bjmf-score]").bind("change",function(){var e=$(this).attr("bjmf-score");void 0!==e&&""!=e&&"0"!=e&&bjmform_score_calc()}),$("[bjmfform_address]").length>0)&&loadScript((void 0===window.sitecdn?"//c.d8n.cn":window.sitecdn)+"/res/app_form_address.js",function(){bjmform_addr_auto()});if(a)$.each(e,function(e,a){$("[name='"+t+"["+e+"]']").prop("disabled",!0),$("[name='"+t+"["+e+"][]']").prop("disabled",!0),$("[bjmfform_address='"+t+"_"+e+"']").find("select, input").prop("disabled",!0),$("[name='"+t+"["+e+"]']:checked").parent().css("color","var(--primary)"),$("[name='"+t+"["+e+"][]']:checked").parent().css("color","var(--primary)")}),$('.form-group[data-type] [name^="fm["]').prop("disabled",!0),$(".form_uploadfile").each(function(){_attach_html=bjmf_attachment_format($(this).val()),$(this).after(_attach_html)}),$(".form-group[data-type=file] .jFiler-input-dragDrop").hide(),$(".form-group[data-type=file] .jFiler-item-trash-action").hide(),$("[bmfe] + .draw_btn").hide(),$(".jFiler a[onclick^=use_alt_upload]").hide();else{$(".form_uploadfile").each(function(){fix_attachments_url(this),html_upload_js($(this).attr("id"),get_current_role(),t)});var i=!1;$("[dic]").each(function(){$(this).attr("dic")&&$(this).attr("dic").length>0&&(i=!0)}),i&&loadScript("/res/app_form_dic.js",function(){dic_init()})}}function bjmform_getdata(e,t){return formToJSArray($(e)[0])[t]}function formToJSArray(e){var t=new FormData(e),a={};return t.forEach((e,t)=>{if(t.includes("[]"))for(var n=t.replace("[]","").split("[").map(function(e){return e.replace("]","")}).filter(function(e){return""!==e}),o=a,r=0;r<n.length;r++){var i=n[r];r===n.length-1?(o[i]||(o[i]=[]),o[i].push(e)):(o[i]||(o[i]={}),o=o[i])}else if(t.includes("["))for(n=t.split("[").map(function(e){return e.replace("]","")}),o=a,r=0;r<n.length;r++){i=n[r];r===n.length-1?o[i]=e:(o[i]||(o[i]={}),o=o[i])}else a[t]=e}),a}function mapsel(e){in_wxapp()?($('<div style="position: absolute;left: 0;top: 0;width: 100%;height: 100%;background: #fff;z-index:99999;" id="bjmf_selmap_div"><iframe id="mapPage" width="100%" height="100%" frameborder=0 src="/'+gconfig.role+'/plugin/mapsel"></iframe>').appendTo("body"),window.bjmf_plugin_selok=function(t,a){$(e).val(t).trigger("change"),$("#bjmf_selmap_div").remove()}):($('<div style="position: absolute;left: 0;top: 0;width: 100%;height: 100%;background: #fff;z-index:99999;" id="bjmf_selmap_div"><iframe id="mapPage" width="100%" height="100%" frameborder=0 src="https://apis.map.qq.com/tools/locpicker?search=1&type=1&key=E6LBZ-RJJCK-TBAJY-A5XM3-6ZR32-SIFZH&referer=myapp"></iframe>').appendTo("body"),setTimeout(function(){$("#bjmf_selmap_div").height($(window).height()),$("#bjmf_selmap_div").width($(window).width()),window.addEventListener("message",function(t){var a=t.data;a&&"locationPicker"==a.module&&(console.log("location",a),$("#bjmf_selmap_div").hide(),_addr=a.poiaddress+"|"+a.latlng.lat.toFixed(5)+","+a.latlng.lng.toFixed(5),$(e).val(_addr).trigger("change"),$("#bjmf_selmap_div").remove())},!1)},2e3))}$(function(){$(".menu-list2 .cell > a").on("click",function(){countFavoriteLink(this)})}),wx_readyed=!1;var geo_quick=[{range:[35.3236,35.3321,113.9075,113.9225],addr:"河南省,新乡市,牧野区,河南师范大学"},{range:[22.5847,22.5896,113.9664,113.9763],addr:"广东省,深圳市,南山区,哈尔滨工业大学(深圳)"},{range:[39.542,39.548,117.389,117.403],addr:"天津市,天津市,宝坻区,北京科技大学天津学院"},{range:[35.29468,35.2991,114.06565,114.07241],addr:"河南省,新乡市,红旗区,新联学院"},{range:[21.16,21.169,110.237,110.252],addr:"广东省,湛江市,麻章区,广东海洋大学寸金学院(新湖校区)"},{range:[36.17,36.1744,120.434,120.44],addr:"山东省,青岛市,李沧区,巨峰路山东外贸职业学院"},{range:[23.141,23.1453,113.3144,113.324],addr:"广东省,广州市,天河区,广州体育学院"},{range:[24.073,24.079,117.531,117.541],addr:"福建省,漳州市,漳浦县,漳州科技学院"},{range:[23.366,23.3705,113.4255,113.431],addr:"广东省,广州市,白云区,广东行政职业学院（白云校区）"},{range:[27.806,27.812,114.886,114.897],addr:"江西省,新余市,渝水区,江西工程学院（天工校区）"},{range:[25.667,25.673,100.292,100.298],addr:"云南省,大理白族自治州,大理市,滇西应用技术大学"},{range:[27.772,27.779,114.841,114.852],addr:"江西省,新余市,渝水区,江西工程学院科技园"},{range:[23.3983,23.4022,113.1848,113.1885],addr:"广东省,广州市,花都区,广东行政职业学院"},{range:[25.8473,25.8514,114.93,114.9323],addr:"江西省,赣州市,章贡区,章贡区赣南师范大学科技学院"},{range:[28.8108,28.8147,111.939,111.944],addr:"湖南省,常德市,汉寿县,湖南高尔夫旅游职业学院"},{range:[30.7463,30.7509,108.4408,108.4565],addr:"重庆市,重庆市,万州区,重庆三峡学院(百安校区)"},{range:[30.7463,30.7563,108.4492,108.4565],addr:"重庆市,重庆市,万州区,重庆三峡学院(百安校区)"},{range:[31.6231,31.63033,118.8976,118.9078],addr:"江苏省,南京市,溧水区,江苏第二师范学院(石湫校区)"},{range:[36.074,36.0757,120.38295,120.385],addr:"山东省,青岛市,市南区,山东外贸职业学院(南校区)"},{range:[38.3815,38.3895,117.3089,117.32],addr:"河北省,沧州市,黄骅市,沧州交通学院"},{range:[34.1326,34.1353,113.8275,113.8297],addr:"河南省,许昌市,建安区,许昌陶瓷职业学院"},{range:[23.1054,23.0983,113.4773,113.4807],addr:"广东省,广州市,黄埔区,广州航海学院红山三路校区"},{range:[44.0711,44.0746,125.1816,125.1754],addr:"吉林省,长春市,宽城区,吉林司法警官职业学院"}];function gps_in_range(e,t,a){return e>=a[0]&&e<=a[1]&&t>=a[2]&&t<=a[3]}function gps_in_ranges(e,t,a){var n=!1;return $.each(a,function(a,o){gps_in_range(e,t,o)&&(n=!0)}),n}function gps_in_ranges_compatible(e,t){if(!e||!t)return null;var a,n;if("string"==typeof e&&(e=e.split(",")),$.isArray(e)?(a=e[0],n=e[1]):$.isPlainObject(e)&&(a=e.lat||e.latitude,n=e.lng||e.longitude),!a||!n)return null;a=parseFloat(a),n=parseFloat(n);var o=!1;if($.isArray(t))gps_in_ranges(a,n,t)&&(o=!0);else{if(null===t.lat||null===t.lng||null===t.radius)return null;geoDistance(a,n,t.lat,t.lng)<=t.radius&&(o=!0)}return o}function bjmf_geo_code_parse(e){var t="",a="",n="";if(void 0!==e.type&&"quick"==e.type)t=e.addr,a=parseFloat(e.lat).toFixed(5),n=parseFloat(e.lng).toFixed(5);else if(void 0!==e.type&&"local"==e.type)t=e.addr,a=parseFloat(e.lat).toFixed(5),n=parseFloat(e.lng).toFixed(5);else{a=e.result.location.lat.toFixed(5),n=e.result.location.lng.toFixed(5);var o=e.result.address_component;t=o.province+","+o.city+","+o.district+","+o.street+o.street_number.replace(o.street,""),void 0!==e.result.formatted_addresses&&void 0!==e.result.formatted_addresses.recommend&&(t+=e.result.formatted_addresses.recommend)}return{lat:a,lng:n,addr:t,addr4bjmf:t+"|"+a+","+n}}function autogps(e,t){if(void 0===e&&(e="[bjmfform_autogps]"),void 0===t&&(t=!0),navigator.userAgent.indexOf("MicroMessenger")>-1){if(wx_readyed)return autogps_cb(e,t);if("undefined"!=typeof wx_js_sign_data&&void 0!==wx_js_sign_data.nonceStr){if("undefined"!=typeof wx_js_signed_by_myself&&wx_js_signed_by_myself)return;return wx.ready(function(){wx_readyed=!0,autogps_cb(e,t)}),void wx.config(wx_js_sign_data)}loadScript("//res.wx.qq.com/open/js/jweixin-1.6.0.js",function(){$.get("/weixin/jsticket?url="+encodeURIComponent(document.location.href),function(a){wx.ready(function(){wx_readyed=!0,autogps_cb(e,t)}),wx.config({debug:!1,appId:a.appId,timestamp:a.timestamp,nonceStr:a.nonceStr,signature:a.signature,jsApiList:["checkJsApi","openLocation","getLocation","getNetworkType"]})},"json")})}else alert("无法自动获取位置，建议在微信中打开以自动获取位置")}function loadWeChat(e,t,a){if(navigator.userAgent.indexOf("MicroMessenger")>-1){if(wx_readyed&&!t)return;loadScript("//res.wx.qq.com/open/js/jweixin-1.6.0.js",function(){$.get("/weixin/jsticket?url="+encodeURIComponent(document.location.href),function(e){wx.ready(function(){wx_readyed=!0,a&&a()});var n=["checkJsApi","openLocation","getLocation","getNetworkType"];t&&(n=n.concat(t)),wx.config({debug:!1,appId:e.appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:n})},"json")})}else e&&alert("建议在微信中打开该页面。")}function localgeo(e){if(window.localStorage){var t=[],a=window.localStorage.getItem("geos");if(a)try{t=JSON.parse(a)}catch(e){console.log("localStorageJSON error")}var n=!1;return $.each(t,function(t,a){var o=Math.abs(parseFloat(a.lat)-parseFloat(e.lat)),r=Math.abs(parseFloat(a.lng)-parseFloat(e.lng));o<=1e-4&&r<=1e-4&&(n=a)}),void 0===e.addr?!1!==n?(e.addr=n.addr,e):null:(!1===n&&(t.push(e),window.localStorage.setItem("geos",JSON.stringify(t))),e)}return null}function bjmf_geo_code_cb(e){"undefined"==typeof bjmf_geo_code?console.log("未定义bjmf_geo_code",e):(localgeo(bjmf_geo_code_parse(e)),bjmf_geo_code(e))}function autogps_cb(e,t){void 0===e&&(e="[bjmfform_autogps]"),void 0===t&&(t=!0),networkType="nothing",wx.getNetworkType({success:function(e){networkType=e.networkType}}),ret=wx.getLocation({type:"gcj02",success:function(a){if("undefined"==typeof bjmf_geo_code&&(window.bjmf_geo_code=function(t){var a=bjmf_geo_code_parse(t);void 0===e&&(e="[bjmfform_autogps]"),$(e).length>0&&$(e).val(a.addr4bjmf)}),!t)return bjmf_geo_code({type:"quick",addr:"",lat:a.latitude,lng:a.longitude});$(e).length>0&&($(e).val("|"+parseFloat(a.latitude).toFixed(5)+","+parseFloat(a.longitude).toFixed(5)),$(".autogps_btn_area").html("已成功获取位置"));var n=localgeo({type:"quick",lat:a.latitude,lng:a.longitude});if(null===n){var o=!1;if($.each(geo_quick,function(e,t){o||gps_in_range(a.latitude,a.longitude,t.range)&&(o=!0,bjmf_geo_code({type:"quick",addr:t.addr,lat:a.latitude,lng:a.longitude}))}),!o){var r={location:a.latitude+","+a.longitude,key:"E6LBZ-RJJCK-TBAJY-A5XM3-6ZR32-SIFZH",get_poi:0,output:"jsonp"};$.ajax({type:"get",url:"https://apis.map.qq.com/ws/geocoder/v1",data:r,dataType:"jsonp",jsonpCallback:"bjmf_geo_code_cb",success:function(e){bjmf_geo_code_cb(e)},error:function(e){console.log(e)}})}}else bjmf_geo_code(n)},fail:function(e){"wifi"!=networkType?alert("获取位置失败（"+JSON.stringify(e)+"），可打开WIFI和定位后再尝试"):alert("获取位置失败（"+JSON.stringify(e)+"），可进行以下操作后再尝试：打开手机定位和授权微信定位权限")},complete:function(e){console.log("complete")},cancel:function(e){console.log("cancel"),alert("已取消，如果需要获取，还可以点上方“自动获取位置”按钮重试")}})}function bjmform_checkform(){return _needfilla=[],$("[bmfe]:visible").each(function(){_t=$(this),_required=!(void 0===_t.attr("bmneed")),_required&&(_v="",void 0===_t.attr("type")||"radio"!=_t.attr("type")&&"checkbox"!=_t.attr("type")?_v=_t.val():$("[name='"+_t.attr("name")+"']:checked").length>0&&(_v=$("[name='"+_t.attr("name")+"']:checked").val()),_fillvalue=_t.attr("name"),_v.trim().length<1&&-1==jQuery.inArray(_fillvalue,_needfilla)&&_needfilla.push(_fillvalue))}),_needfilla.length>0?(alert("还有"+_needfilla.length+"项必填项没有填写，填写后再提交"),!1):(bjmform_score_calc(),$("[type=file]").remove(),!0)}function bjmf_rdochk_ini(){bjmf_rdochecked(".bjmfrdochk"),$(".rdobox").unbind("click",bjmf_rdochecked_rdo).bind("click",bjmf_rdochecked_rdo),$(".chkbox").unbind("click",bjmf_rdochecked_chk).bind("click",bjmf_rdochecked_chk)}function bjmf_rdochecked_rdo(){$(this).prev().prop("checked","checked"),bjmf_rdochecked(".bjmfrdochk")}function bjmf_rdochecked_chk(){1==$(this).prev().prop("checked")?$(this).prev().removeAttr("checked"):$(this).prev().prop("checked","checked"),bjmf_rdochecked(".bjmfrdochk"),"undefined"!=typeof cb_bjmf_rdochecked_chged&&cb_bjmf_rdochecked_chged($(this).prev())}function bjmf_rdochecked(e){$(e).each(function(t){var a=$(e).eq(t).next();0==$(e).eq(t).prop("checked")?(a.removeClass("checked"),a.addClass("unchecked"),a.find(".check-image").css("background","url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAbUExURQAAALW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tW01flwAAAAIdFJOUwDtBpHukImILT7eIAAAACdJREFUCNdjYCANMBk6K4AZrB0dBWAGY0eHACoDKJUAUWwCVUw8AADNiwZs9OOD8wAAAABJRU5ErkJggg==)")):(a.removeClass("unchecked"),a.addClass("checked"),a.find(".check-image").css("background","url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABmUExURQAAAP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////5WfaagAAAAhdFJOUwCenbkBCpUCA6ShB5+qkLSbkqu9mqIEpoqEiMCWCZy4mI+19xIAAABoSURBVCjPpY83FsMwFMPgIn/J6b0X3P+SWZJnZ8gUblhAEv5LPB/pi+/ajLlWq4H3M7VruZUzALlX+wwXPQJ5p04DuKonclGrAIiiztdqHW/5QVVX7Uc/aVSXMRSmjW5jPDEtuvbnnxeJXQfKWoecZgAAAABJRU5ErkJggg==)"))})}function fix_attachments_url(e){if(e.value&&!e.value.startsWith("[{")){var t=e.value.split(",");if(1!==t.length||t[0]){var a=[];$.each(t,function(e,t){a.push({name:"附件 "+(e+1),file:t,size:1,type:""})}),e.value=JSON.stringify(a)}}}function wxtask_noticeadd_cb(e){return void 0===e.s?"请求返回异常":"ok"==e.s?"已开始提醒":"repeat"==e.s?"已提醒过，一个事件的全员提醒，一天只能提醒一次":""}function wxtask_notice(e,t,a,n,o){_postdata={flag:t,url:a,title:n},""==dealUndefined(o)?_postdata.courseids=e:_postdata.groupids=o,$.post("/teacher/course/"+e+"/wxtasknotice",_postdata,function(e){alert(wxtask_noticeadd_cb(e))},"json")}function pick_event_ask2add(e){bjmf_prompt(e.title,function(t){pick_event_add(e.course_id,e.flag,e.studentids,t,e.remark)},e.defaultv)}function pick_event_add(e,t,a,n,o){var r={flag:t,studentids:a,v:n,name:o},i="/teacher/picks/course/"+e+"/quick";gconfig&&gconfig.role&&"org"==gconfig.role&&(i="/org/picks/quick",r.course_id=e),$.post(i,r,function(e){void 0===e.s&&alert("请求返回异常，可尝试重试"),"ok"==e.s&&alert("已完成批量记分"),"repeat"==e.s&&alert("当前事件已记分过一遍啦")},"json")}function dealUndefined(e){return void 0===e?(console.log("something undefined"),""):e}function renderPagination(){var e=window.__pagination__;if(e)if(window.layui)layui.use(["laypage"],function(){layui.laypage.render({elem:"pagination",limit:e.limit,curr:e.page,count:e.total,jump:function(e,t){t||(location.href="?limit="+e.limit+"&page="+e.curr)}})});else{var t=$("#pagination");t.html('<ul class="pagination justify-content-center my-3">\n    <li class="page-item first disabled">\n      <a class="page-link" href="#">首页</a>\n    </li>\n    <li class="page-item prev disabled"><a class="page-link" href="#">上一页</a></li>\n    <li class="page-item current"><a class="page-link" href="#">1</a></li>\n    <li class="page-item next disabled"><a class="page-link" href="#">下一页</a></li>\n    <li class="page-item last disabled">\n      <a class="page-link" href="#">末页</a>\n    </li>\n  </ul>');var a="?limit="+e.limit+"&page=",n=t.find(".page-item");n.filter(".current").find("a").text(e.page).attr("href",a+e.page),e.page>1&&(n.filter(".prev").removeClass("disabled").find("a").attr("href",a+(e.page-1)),n.filter(".first").removeClass("disabled").find("a").attr("href",a+1)),e.page*e.limit<e.total&&(n.filter(".next").removeClass("disabled").find("a").attr("href",a+(e.page+1)),n.filter(".last").removeClass("disabled").find("a").attr("href",a+Math.ceil(e.total/e.limit)))}}function auto_bjmfHelp(){$("[bjmf-help]").click(function(){var e=$(this);e.css("cursor","pointer");var t="alert";if(e.attr("help-type")&&(t=e.attr("help-type")),"iframe"==t)bjmf_iframe(e.attr("help-url"),e.attr("help-title"));else{var a=e.attr("help-content");a||(a=$(e.attr("bjmf-help")).html()),bjmf_alert(a,e.attr("help-title"))}})}function getLayer(e){"object"==typeof layer?e(layer):loadScript(("undefined"==typeof sitecdn?"//c.d8n.cn":window.sitecdn)+"/layer/layer.js",function(){e(layer)})}function bjmf_msg(e){getLayer(function(t){t.msg(e)})}function bjmf_tips(e,t){getLayer(function(a){a.tips(e,t)})}function bjmf_alert(e){getLayer(function(t){t.alert(e)})}function bjmf_confirm(e,t,a){getLayer(function(n){n.confirm(e,{},t,a)})}function bjmf_iframe(e,t,a){getLayer(function(n){n.open({type:2,title:t,area:[.9*$(window).width()+"px",.9*$(window).height()+"px"],content:e,end:function(){void 0!==a&&a()}})})}function bjmf_prompt(e,t,a){getLayer(function(n){n.prompt({value:a||"",title:e},function(e,a,o){t(e),n.close(a)})})}function bjmf_attachment_format(e,t){return"string"==typeof e&&"["==e.substr(0,1)&&"]"==e.substr(e.length-1,1)&&e.indexOf('"file"')>-1&&e.indexOf('"name"')>-1?(_aahtml="",_aa=JSON.parse(e),$.each(_aa,function(e,a){_aahtml+=void 0===t?'<a target="_blank" href="'+a.file+'">附件'+(e+1)+"</a> ":'<a href="javascript:void(0);" onclick="'+t+"('"+a.file+"')\">附件"+(e+1)+"</a> "}),_aahtml):e}function easyui_attachment_format(e,t,a){return bjmf_attachment_format(e,void 0)}function cutString(e,t){if(2*e.length<=t)return e;for(var a=0,n="",o=0;o<e.length;o++)if(n+=e.charAt(o),e.charCodeAt(o)>128){if((a+=2)>=t)return n.substring(0,n.length-1)+"..."}else if((a+=1)>=t)return n.substring(0,n.length-2)+"...";return n}function bjmf_cmdbar(e,t){$("<style>.bjmf-cmdbar{font-size:14px;color:#555}.bjmf-cmdbar-items{clear:both;margin:0;padding:0}.bjmf-cmdbar-item{padding:0 4px;margin:0;border:0;cursor:pointer;display:inline-block}.bjmf-cmdbar-item i{padding:0 4px;color:#0078d4;height:22px;line-height:22px}.bjmf-cmdbar-item span{padding:0}.bjmf-cmdbar-showarea{overflow:hidden}.bjmf-cmdbar-showarea li{float:left}.bjmf-cmdbar-morearea{position:relative;text-align:right;display:none}</style>").appendTo("body"),_bjmf_cmdbar_html='<div class="bjmf-cmdbar"><ul class="bjmf-cmdbar-items bjmf-cmdbar-showarea"></ul><ul class="bjmf-cmdbar-items bjmf-cmdbar-morearea"></ul></div>',$(e).html(_bjmf_cmdbar_html),$.each(t,function(e,t){_tmpstyle="",void 0!==t.style&&(_tmpstyle=t.style),_bjmfcmdbar_tmp_html='<li class="bjmf-cmdbar-item" style="'+_tmpstyle+'"><i class="'+t.icon+'"></i><span>'+t.title+"</span></li>",$(_bjmfcmdbar_tmp_html).bind("click",t.click).appendTo(".bjmf-cmdbar-showarea")}),_morebtnhtml='<li class="bjmf-cmdbar-item" onclick="$(\'.bjmf-cmdbar-morearea\').toggle();"><i class="las la-ellipsis-h"></i></li>',_morebtnlen=30,_maxlen=$(".bjmf-cmdbar").width()-_morebtnlen,_curlen=0,_willAddToMore=!1,_allea=$(".bjmf-cmdbar-showarea").find(".bjmf-cmdbar-item"),_allealen=_allea.length,_lastlen=_maxlen,_allea.each(function(e,t){return _willAddToMore?($(this).clone(!0).appendTo(".bjmf-cmdbar-morearea"),void $(this).remove()):(_thisitemlen=$(this).outerWidth(),_curlen+_thisitemlen>_maxlen?($(_morebtnhtml).appendTo(".bjmf-cmdbar-showarea"),_willAddToMore=!0,$(this).clone(!0).appendTo(".bjmf-cmdbar-morearea"),void $(this).remove()):(_curlen+=_thisitemlen,void(_lastlen=_maxlen-_curlen)))})}function href(e){document.location.href=e}function geoDistance(e,t,a,n){let o=rad(e),r=rad(a),i=o-r,l=rad(t)-rad(n),c=2*Math.asin(Math.sqrt(Math.pow(Math.sin(i/2),2)+Math.cos(o)*Math.cos(r)*Math.pow(Math.sin(l/2),2)));return c*=6378137,c=Math.round(c)}function rad(e){return e*Math.PI/180}function geoDistance2Ranges(e,t,a){if(0==a.length)return-1;for(var n=1e7,o=0;o<a.length;o++){var r=a[o],i=geoDistance(e,t,r[0],r[1])-r[2];if(n=Math.min(n,i),i<=50)return-1}return n}function bjmf_timestamp2str(e){for(var t=(e+"").split(""),a=0;a<13;a++)t[a]||(t[a]="0");e=1*t.join("");var n=(new Date).getTime()-e;if(n<0)return"不久前";var o,r=n/2592e6,i=n/6048e5,l=n/864e5,c=n/36e5,d=n/6e4,s=function(e){return e<10?"0"+e:e};return r>12?(o=new Date(e)).getFullYear()+"年"+s(o.getMonth()+1)+"月"+s(o.getDate())+"日":r>=1?parseInt(r)+"月前":i>=1?parseInt(i)+"周前":l>=1?parseInt(l)+"天前":c>=1?parseInt(c)+"小时前":d>=1?parseInt(d)+"分钟前":"刚刚"}function bjmf_form_filldata(_form_jq_object,___formdata){_form_jq_object.find("input,select,textarea").each(function(){if(_ele_e=$(this),_ele_e.is("[name]")){_ele_name=_ele_e.attr("name").trim(),_is_array=!1,"[]"==_ele_name.substr(_ele_name.length-2)?_v_k=_ele_name.substr(0,_ele_name.length-2):_v_k=_ele_name,_v_k="___formdata."+_v_k.replace(/]/g,"").replace(/\[/g,".");try{___v=eval(_v_k)}catch(e){return}"undefined"!=typeof ___v&&(_ele_e.is("input")&&"checkbox"==_ele_e.attr("type")?___v.indexOf(_ele_e.val())>-1&&_ele_e.prop("checked",!0):_ele_e.is("select")&&_ele_e.is("[multiple]")?_ele_e.find("option").each(function(){___v.indexOf($(this).attr("value"))>-1&&$(this).prop("selected",!0)}):_ele_e.is("input")&&"radio"==_ele_e.attr("type")?_ele_e.val()==___v&&_ele_e.prop("checked",!0):_ele_e.val(___v))}})}function urladd(e,t){for(_urlk in void 0!==t&&""!=t&&0!=t||(t=document.location.href),e)t=changeQueryString(_urlk,e[_urlk],t);return t}function urlallflow(e,t){void 0!==t&&""!=t&&0!=t||(t=document.location.href),$("a[href]").each(function(){var a=$(this),n=a.attr("href");if("#"!=n.sub(0,1)&&"javascript:"!=n.sub(0,11)&&"tel:"!=n.sub(0,4)){var o=urlflow(n,t,e);a.attr("href",o)}})}function urlflow(e,t,a){if(void 0!==t&&""!=t&&0!=t||(t=document.location.href),-1==t.indexOf("?"))return e;null==a&&(a=!1);var n=t.substr(t.indexOf("?")+1).split("&");for(_qs_i in n){var o=n[_qs_i];if(-1!=o.indexOf("=")){var r=o.split("=");!1!==a&&-1==a.indexOf(r[0])||(e=changeQueryString(r[0],r[1],e,!0))}}return e}function changeQueryString(e,t,a,n){if(null==t)return a;if(null==n&&(n=!1),-1==a.indexOf("?"))return a+"?"+e+"="+t;var o=!1,r=a.substr(a.indexOf("?")+1).split("&");for(_qs_i in r){var i=r[_qs_i];if(-1!=i.indexOf("="))i.split("=")[0]==e&&(o=!0,n||(!1===t?r.splice(_qs_i,1):r[_qs_i]=e+"="+t))}return o||r.push(e+"="+t),a.substr(0,a.indexOf("?"))+"?"+r.join("&")}$(function(){auto_bjmfHelp(),autoLinkTextNodes(),bjmf_rdochk_ini(),renderPagination(),$(".form-control-datetimepicker").on("click",function(){weuidatetimepicker(this)}),$(".form-control-timepicker").on("click",function(){weuitimepicker(this)}),addRedDots(),$(".text2html").each(function(){var e=$(this);e.html(text2html(e.text()))})});var data_bjmf_course_getdata_data={};function bjmf_course_getdata(e,t,a){var n=parseInt((new Date).valueOf()/1e3),o="cd_"+e+"_"+t;if(void 0!==data_bjmf_course_getdata_data[o])return a(data_bjmf_course_getdata_data[o]);"undefined"==typeof urlRoot&&(urlRoot="/"+document.location.pathname.split("/")[1]);var r=urlRoot+"/data/course/"+(e||0)+"/"+t;if(window.localStorage){var i=!1,l=window.localStorage.getItem(o),c=window.localStorage.getItem(o+"_lask");if(l)try{i=JSON.parse(l)}catch(e){console.log("localStorageJSON error")}if(i){var d=i.v,s=i.data;if(n-d<180)return console.log(o,"3分钟内新数据，不再问"),"undefined"!=typeof bjmf_filter_coursedata&&(s=bjmf_filter_coursedata(t,s)),data_bjmf_course_getdata_data[o]=s,a(s);if(n-c<180)return console.log(o,"3分钟内问询过，不再问"),"undefined"!=typeof bjmf_filter_coursedata&&(s=bjmf_filter_coursedata(t,s)),data_bjmf_course_getdata_data[o]=s,a(s);$.ajax({url:r+"?v="+d,ldatakey:o,vnow:n,ltruedata:s,success:function(e){window.localStorage.setItem(this.ldatakey+"_lask",this.vnow),void 0!==e.noc&&1==e.noc?("undefined"!=typeof bjmf_filter_coursedata&&(s=bjmf_filter_coursedata(t,this.ltruedata)),data_bjmf_course_getdata_data[this.ldatakey]=this.ltruedata,a(this.ltruedata)):(window.localStorage.setItem(this.ldatakey,JSON.stringify(e)),"undefined"!=typeof bjmf_filter_coursedata&&(s=bjmf_filter_coursedata(t,e.data)),data_bjmf_course_getdata_data[this.ldatakey]=s,a(s))},dataType:"json"})}else $.ajax({url:r+"?f=1&v="+n,ldatakey:o,success:function(e){window.localStorage.setItem(this.ldatakey,JSON.stringify(e)),"undefined"!=typeof bjmf_filter_coursedata&&(s=bjmf_filter_coursedata(t,e.data)),data_bjmf_course_getdata_data[this.ldatakey]=s,a(s)},dataType:"json"})}}function hideLayUiMenuInIframe(){window.parent&&window.parent!==window&&($("#leftmenuarea").remove(),$("#LAY_app_body").css({left:0}),$(function(){var e=$("#headmenuarea");e.find("> .layui-layout-right").remove(),e.find("> .layui-layout-left").css({left:0}).find("> li:not(:first)").remove()}))}function navpod(e,t,a){bjmf_course_getdata(e,"navpod",function(n){for(_np_item_key in _np_html="",n)_item=n[_np_item_key],_np_html+=navpod_item2html(_item,e,t);$("#navpod").html(_np_html),"function"==typeof a&&a(n)})}function navpod_item2html(e,t,a){return void 0===e.id||void 0===e.name?"":(void 0!==e.url?"string"==typeof e.url?_url=e.url:_url=e.url[role]:_url=menucode2url(e.id,t,a),_url=_url.replace("{ROLE}",a).replace("{COURSEID}",t),_url=_url.replace("/ROLE/","/"+a+"/").replace("/COURSEID/","/"+t+"/"),tpl2html($("#tpl_navpod_item").html(),{url:_url,item:e}))}function menucode2url(e,t,a){return _url="",_ca=e.split("@"),_modulecode=_ca[0],"profile"==_modulecode&&(_ca.length>1?_ca[1].indexOf(",")>-1?_url=_url="/{ROLE}/course/{COURSEID}/profiles?ids="+_ca[1]:_url="/{ROLE}/course/{COURSEID}/profile/"+_ca[1]:_url="/{ROLE}/course/{COURSEID}/profiles"),"activity"==_modulecode&&(_ca.length>1?_ca[1].indexOf(",")>-1?_url=_url="/{ROLE}/course/{COURSEID}/activitys?ids="+_ca[1]:_url="/{ROLE}/course/{COURSEID}/activitys/show?id="+_ca[1]:_url="/{ROLE}/course/{COURSEID}/activitys"),_url}function installOptionalBox(){$(".optional-box-ctrl").each(function(){var e=$(this),t=e.find(".la"),a=e.siblings(".optional-box");e.on("click",function(){t.hasClass("la-angle-double-down")?(t.removeClass("la-angle-double-down").addClass("la-angle-double-up"),a.removeClass("hide")):(t.removeClass("la-angle-double-up").addClass("la-angle-double-down"),a.addClass("hide"))})})}function openLocation(e){if(!e)return alert("地址为空！");if(!e.split)return alert("无效地址："+e);var t=e.split(",");if(!t||!t[0]||!t[1])return alert("无效地址："+e);if(!window.wx||!window.wx.openLocation)return openMap(e);try{wx.openLocation({latitude:Number(t[0]),longitude:Number(t[1]),scale:22,fail:function(t){t&&"openLocation:fail"===t.errMsg?openMap(e):alert("打开地图失败！"+(t?t.errMsg:null)||"未知错误")}.bind(this)})}catch(e){alert("打开地图失败："+e.message)}}function openMap(e){window.open("http://api.map.baidu.com/geocoder?location="+e+"&coord_type=gcj02&output=html&src=com.banjimofang")}function clearlocal(e){void 0===e?confirm("确认清理本地缓存?  系统可能会将一些班级学生列表保存到本地缓存，如果本地网络异常导致没有及时更新，可能会导致新加入学生不显示姓名等问题出现。可在此手动清理以加载最新数据。")&&(localStorage.clear(),alert("清理完成")):localStorage.clear()}function in_weixin(){return navigator.userAgent.indexOf("MicroMessenger")>-1}function in_wxapp(){return navigator.userAgent.indexOf("miniProgram")>-1}function show_draw_pad(e){loadScript((void 0===window.sitecdn?"//c.d8n.cn":window.sitecdn)+"/js/common/draw_pad.js?v=2023091901",function(){new DrawPad(e).show()})}function render_draw_pad(e){loadScript((void 0===window.sitecdn?"//c.d8n.cn":window.sitecdn)+"/js/common/draw_pad.js?v=2023091901",function(){"function"==typeof e?e():DrawPad.renderResult(e)})}$(function(){installOptionalBox()});var loaded_app_js=!0;try{window.parent!==window&&window.parent.location.href.indexOf("/org")>=0&&($("html").addClass("embed-in-org"),$(function(){hideLayUiMenuInIframe()}))}catch(e){console.log(e)}